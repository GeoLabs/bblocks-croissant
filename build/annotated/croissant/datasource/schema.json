{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Croissant DataSource",
  "description": "DataSource describes how to extract and optionally transform data from files\nto populate RecordSet fields. It specifies the source, extraction method,\ntransformations, and parsing formats.\n",
  "type": "object",
  "properties": {
    "fileObject": {
      "type": "object",
      "required": [
        "@id"
      ],
      "properties": {
        "@id": {
          "type": "string",
          "description": "Reference to the source FileObject"
        }
      },
      "x-jsonld-id": "http://mlcommons.org/croissant/fileObject"
    },
    "fileSet": {
      "type": "object",
      "required": [
        "@id"
      ],
      "properties": {
        "@id": {
          "type": "string",
          "description": "Reference to the source FileSet"
        }
      },
      "x-jsonld-id": "http://mlcommons.org/croissant/fileSet"
    },
    "recordSet": {
      "type": "object",
      "required": [
        "@id"
      ],
      "properties": {
        "@id": {
          "type": "string",
          "description": "Reference to another RecordSet as source"
        }
      },
      "x-jsonld-id": "http://mlcommons.org/croissant/recordSet"
    },
    "extract": {
      "type": "object",
      "description": "Specifies how to extract data from the source. Different properties\nare used depending on the source type (CSV, JSON, file properties, etc.)\n",
      "properties": {
        "column": {
          "type": "string",
          "description": "Column name for CSV/TSV files",
          "x-jsonld-id": "http://mlcommons.org/croissant/column"
        },
        "fileProperty": {
          "type": "string",
          "enum": [
            "fullpath",
            "filename",
            "content",
            "lines",
            "lineNumbers"
          ],
          "description": "Property of FileObject/FileSet to extract:\n- fullpath: Full path to the file (e.g., \"data/train/img.jpg\")\n- filename: Just the filename (e.g., \"img.jpg\")\n- content: Binary/text content of the file\n- lines: Content split by lines\n- lineNumbers: Line numbers (0-indexed)\n",
          "x-jsonld-id": "http://mlcommons.org/croissant/fileProperty"
        },
        "jsonPath": {
          "type": "string",
          "description": "JSONPath expression for extracting from JSON files",
          "x-jsonld-id": "http://mlcommons.org/croissant/jsonPath"
        }
      },
      "x-jsonld-id": "http://mlcommons.org/croissant/extract"
    },
    "transform": {
      "type": "object",
      "description": "Transformations to apply to extracted data.\n",
      "properties": {
        "regex": {
          "type": "string",
          "description": "Regular expression to extract or parse data.\nCaptured groups are returned. If no groups, the entire match is returned.\n",
          "x-jsonld-id": "http://mlcommons.org/croissant/regex"
        },
        "delimiter": {
          "type": "string",
          "description": "Character to split strings into arrays",
          "x-jsonld-id": "http://mlcommons.org/croissant/delimiter"
        },
        "jsonQuery": {
          "type": "string",
          "description": "JSON query to evaluate on JSON data"
        },
        "replace": {
          "type": "object",
          "description": "String replacement",
          "properties": {
            "pattern": {
              "type": "string"
            },
            "replacement": {
              "type": "string"
            }
          }
        },
        "separator": {
          "type": "string",
          "description": "Deprecated - use delimiter instead",
          "x-jsonld-id": "http://mlcommons.org/croissant/separator"
        }
      },
      "x-jsonld-id": "http://mlcommons.org/croissant/transform"
    },
    "format": {
      "type": "string",
      "description": "Format string for parsing extracted values into typed data.\nExamples:\n- Date/DateTime: \"yyyy-MM-dd\", \"MM/dd/yyyy HH:mm:ss\"\n- Numbers: \"0.##E0\" (scientific notation)\n- BoundingBox: \"CENTER_XYWH\", \"XYXY\"\n",
      "x-jsonld-id": "http://mlcommons.org/croissant/format"
    }
  },
  "examples": [
    {
      "title": "Extract CSV column",
      "content": "Basic extraction from a CSV file",
      "snippets": [
        {
          "language": "json",
          "code": "{\n  \"fileObject\": { \"@id\": \"data.csv\" },\n  \"extract\": { \"column\": \"user_name\" }\n}\n"
        }
      ]
    },
    {
      "title": "Extract filename from FileSet",
      "content": "Get filenames from a collection of files",
      "snippets": [
        {
          "language": "json",
          "code": "{\n  \"fileSet\": { \"@id\": \"images\" },\n  \"extract\": { \"fileProperty\": \"filename\" }\n}\n"
        }
      ]
    },
    {
      "title": "Regex transformation",
      "content": "Extract part of a filename using regex",
      "snippets": [
        {
          "language": "json",
          "code": "{\n  \"fileSet\": { \"@id\": \"images\" },\n  \"extract\": { \"fileProperty\": \"filename\" },\n  \"transform\": {\n    \"regex\": \"img_([0-9]+)\\\\.jpg\"\n  }\n}\n"
        }
      ]
    },
    {
      "title": "Extract with date parsing",
      "content": "Parse a date column with specific format",
      "snippets": [
        {
          "language": "json",
          "code": "{\n  \"fileObject\": { \"@id\": \"events.csv\" },\n  \"extract\": { \"column\": \"event_date\" },\n  \"format\": \"yyyy-MM-dd\"\n}\n"
        }
      ]
    },
    {
      "title": "JSONPath extraction",
      "content": "Extract nested values from JSON",
      "snippets": [
        {
          "language": "json",
          "code": "{\n  \"fileObject\": { \"@id\": \"metadata.json\" },\n  \"extract\": { \"jsonPath\": \"$.annotations[*].category\" }\n}\n"
        }
      ]
    },
    {
      "title": "Multiple transformations",
      "content": "Apply several transformations in sequence",
      "snippets": [
        {
          "language": "json",
          "code": "{\n  \"fileSet\": { \"@id\": \"images\" },\n  \"extract\": { \"fileProperty\": \"fullpath\" },\n  \"transform\": [\n    { \"regex\": \"^(train|val|test)/\" },\n    { \"replace\": { \"pattern\": \"val\", \"replacement\": \"validation\" } }\n  ]\n}\n"
        }
      ]
    },
    {
      "title": "Split string into array",
      "content": "Convert delimited string to array",
      "snippets": [
        {
          "language": "json",
          "code": "{\n  \"fileObject\": { \"@id\": \"tags.csv\" },\n  \"extract\": { \"column\": \"tag_list\" },\n  \"transform\": { \"delimiter\": \",\" }\n}\n"
        }
      ]
    }
  ],
  "x-jsonld-vocab": "https://schema.org/",
  "x-jsonld-prefixes": {
    "cr": "http://mlcommons.org/croissant/"
  }
}