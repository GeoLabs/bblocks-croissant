

{
  "itemIdentifier": "mlc.croissant.datasource",
  "$schema": "https://raw.githubusercontent.com/opengeospatial/bblocks-postprocess/master/ogc/bblocks/metadata-schema.yaml",
  "name": "Croissant DataSource",
  "abstract": "Specifies how to extract and transform data from files for Croissant fields",
  "description": "## Croissant DataSource\n\nDataSource specifies how to extract, transform, and format data from files to populate fields in a RecordSet. It's a powerful abstraction that handles the complexity of reading data from heterogeneous sources.\n\n### Key Features\n\n- **Multiple Source Types**: CSV, JSON, FileSet, FileObject, other RecordSets\n- **Flexible Extraction**: Column names, file properties, JSONPath expressions\n- **Data Transformations**: Regex, string splitting, replacements\n- **Type Parsing**: Format strings for dates, numbers, coordinates\n\n### Structure\n\nA DataSource consists of three main parts:\n\n1. **Source**: What to read from (`fileObject`, `fileSet`, or `recordSet`)\n2. **Extract**: How to get the data (column, file property, JSONPath)\n3. **Transform** (optional): How to modify the data (regex, delimiter)\n4. **Format** (optional): How to parse into typed values\n\n### Source Types\n\n#### FileObject Source\nRead from a specific file:\n```json\n{\n  \"fileObject\": { \"@id\": \"data.csv\" }\n}\n```\n\n#### FileSet Source\nRead from each file in a collection:\n```json\n{\n  \"fileSet\": { \"@id\": \"image-files\" }\n}\n```\n\n#### RecordSet Source\nReference another RecordSet (for joins):\n```json\n{\n  \"recordSet\": { \"@id\": \"metadata\" }\n}\n```\n\n### Extraction Methods\n\nDifferent extraction methods for different source types:\n\n#### CSV/TSV Files\n```json\n{\n  \"fileObject\": { \"@id\": \"data.csv\" },\n  \"extract\": { \"column\": \"column_name\" }\n}\n```\n\n#### File Properties\nFor FileObject or FileSet:\n\n```json\n{\n  \"fileSet\": { \"@id\": \"images\" },\n  \"extract\": { \"fileProperty\": \"filename\" }\n}\n```\n\nAvailable file properties:\n- `fullpath`: Complete path (e.g., `train/images/img001.jpg`)\n- `filename`: Just the name (e.g., `img001.jpg`)\n- `content`: Binary/text content\n- `lines`: Content split by newlines\n- `lineNumbers`: Line numbers (0-indexed)\n\n#### JSON Data\n```json\n{\n  \"fileObject\": { \"@id\": \"annotations.json\" },\n  \"extract\": { \"jsonPath\": \"$.images[*].id\" }\n}\n```\n\n### Transformations\n\nApply operations to extracted data:\n\n#### Regex Extraction\nExtract parts of strings using regular expressions:\n```json\n{\n  \"extract\": { \"fileProperty\": \"filename\" },\n  \"transform\": { \"regex\": \"image_([0-9]+)\\\\.jpg\" }\n}\n```\n\nCaptures the number from `image_123.jpg` \u2192 `123`\n\n#### String Splitting\nConvert delimited strings to arrays:\n```json\n{\n  \"extract\": { \"column\": \"tags\" },\n  \"transform\": { \"delimiter\": \",\" }\n}\n```\n\nConverts `\"tag1,tag2,tag3\"` \u2192 `[\"tag1\", \"tag2\", \"tag3\"]`\n\n#### String Replacement\nReplace patterns in strings:\n```json\n{\n  \"transform\": {\n    \"replace\": {\n      \"pattern\": \"old_value\",\n      \"replacement\": \"new_value\"\n    }\n  }\n}\n```\n\n#### Multiple Transformations\nApply transformations in sequence:\n```json\n{\n  \"transform\": [\n    { \"regex\": \"^(train|val)/\" },\n    { \"replace\": { \"pattern\": \"val\", \"replacement\": \"validation\" } }\n  ]\n}\n```\n\n### Format Strings\n\nParse typed values from text:\n\n#### Dates and Times\n```json\n{\n  \"extract\": { \"column\": \"created_at\" },\n  \"format\": \"yyyy-MM-dd HH:mm:ss\"\n}\n```\n\nCommon patterns:\n- `yyyy-MM-dd` \u2192 `2025-12-16`\n- `MM/dd/yyyy` \u2192 `12/16/2025`\n- `yyyy-MM-dd'T'HH:mm:ss'Z'` \u2192 `2025-12-16T10:30:00Z`\n\n#### Numbers\n```json\n{\n  \"extract\": { \"column\": \"scientific_value\" },\n  \"format\": \"0.##E0\"\n}\n```\n\nParses scientific notation like `1.5E10`\n\n#### Bounding Boxes\n```json\n{\n  \"extract\": { \"column\": \"bbox\" },\n  \"format\": \"CENTER_XYWH\"\n}\n```\n\nFormats:\n- `XYWH`: [x, y, width, height]\n- `XYXY`: [x1, y1, x2, y2]\n- `CENTER_XYWH`: [center_x, center_y, width, height]\n\n### Common Patterns\n\n#### Simple CSV Column\n```json\n{\n  \"fileObject\": { \"@id\": \"users.csv\" },\n  \"extract\": { \"column\": \"email\" }\n}\n```\n\n#### Image Content\n```json\n{\n  \"fileSet\": { \"@id\": \"training-images\" },\n  \"extract\": { \"fileProperty\": \"content\" }\n}\n```\n\n#### Extract Split from Path\n```json\n{\n  \"fileSet\": { \"@id\": \"all-images\" },\n  \"extract\": { \"fileProperty\": \"fullpath\" },\n  \"transform\": { \"regex\": \"^(train|val|test)/\" }\n}\n```\n\n#### Parse Date\n```json\n{\n  \"fileObject\": { \"@id\": \"events.csv\" },\n  \"extract\": { \"column\": \"timestamp\" },\n  \"format\": \"yyyy-MM-dd\"\n}\n```\n\n#### JSON Nested Data\n```json\n{\n  \"fileObject\": { \"@id\": \"coco_annotations.json\" },\n  \"extract\": { \"jsonPath\": \"$.annotations[*].bbox\" }\n}\n```\n\n### Best Practices\n\n1. **Keep transforms simple**: Complex logic should be pre-processing\n2. **Document regex patterns**: Add comments explaining what they match\n3. **Use appropriate formats**: Match format strings to actual data\n4. **Test extractions**: Verify patterns work on sample data\n5. **Prefer standard formats**: Use ISO 8601 for dates when possible\n\n### Performance Considerations\n\n- **Large files**: JSONPath on huge files can be slow\n- **Complex regex**: Keep patterns simple for performance\n- **Multiple transforms**: Each adds processing time\n\n### Error Handling\n\nWhat happens when:\n- **Column not found**: Error - column must exist\n- **Regex no match**: Returns empty/null\n- **Format mismatch**: Error - data must match format\n- **JSONPath no results**: Returns empty array\n\n### Related Building Blocks\n\n- **Field**: Uses DataSource to specify where data comes from\n- **FileObject**: Common source for DataSource\n- **FileSet**: Used when extracting from file collections\n- **RecordSet**: Contains fields that use DataSources\n",
  "status": "under-development",
  "dateTimeAddition": "2025-12-16T00:00:00Z",
  "dateOfLastChange": "2025-12-19",
  "version": "1.0",
  "itemClass": "schema",
  "register": "mlc-croissant",
  "dependsOn": [
    "mlc.croissant.fileobject",
    "mlc.croissant.fileset"
  ],
  "tags": [
    "croissant",
    "data extraction",
    "transformation",
    "parsing"
  ],
  "sourceLdContext": "https://geolabs.github.io/bblocks-croissant/_sources/datasource/context.jsonld",
  "sourceSchema": "https://geolabs.github.io/bblocks-croissant/_sources/datasource/schema.yaml",
  "sources": [
    {
      "title": "Croissant Format Specification v1.0 - DataSource",
      "link": "https://docs.mlcommons.org/croissant/docs/croissant-spec.html#datasource"
    }
  ],
  "maturity": "development",
  "group": "MLCommons",
  "shaclShapes": {},
  "ldContext": "https://geolabs.github.io/bblocks-croissant/build/annotated/croissant/datasource/context.jsonld",
  "schema": {
    "application/yaml": "https://geolabs.github.io/bblocks-croissant/build/annotated/croissant/datasource/schema.yaml",
    "application/json": "https://geolabs.github.io/bblocks-croissant/build/annotated/croissant/datasource/schema.json"
  },
  "sourceFiles": "https://geolabs.github.io/bblocks-croissant/_sources/datasource/",
  "rdfData": [],
  "validationPassed": true,
  "annotatedSchema": "$schema: https://json-schema.org/draft/2020-12/schema\ntitle: Croissant DataSource\ndescription: 'DataSource describes how to extract and optionally transform data from\n  files\n\n  to populate RecordSet fields. It specifies the source, extraction method,\n\n  transformations, and parsing formats.\n\n  '\ntype: object\nproperties:\n  fileObject:\n    type: object\n    required:\n    - '@id'\n    properties:\n      '@id':\n        type: string\n        description: Reference to the source FileObject\n    x-jsonld-id: http://mlcommons.org/croissant/fileObject\n  fileSet:\n    type: object\n    required:\n    - '@id'\n    properties:\n      '@id':\n        type: string\n        description: Reference to the source FileSet\n    x-jsonld-id: http://mlcommons.org/croissant/fileSet\n  recordSet:\n    type: object\n    required:\n    - '@id'\n    properties:\n      '@id':\n        type: string\n        description: Reference to another RecordSet as source\n    x-jsonld-id: http://mlcommons.org/croissant/recordSet\n  extract:\n    type: object\n    description: 'Specifies how to extract data from the source. Different properties\n\n      are used depending on the source type (CSV, JSON, file properties, etc.)\n\n      '\n    properties:\n      column:\n        type: string\n        description: Column name for CSV/TSV files\n        x-jsonld-id: http://mlcommons.org/croissant/column\n      fileProperty:\n        type: string\n        enum:\n        - fullpath\n        - filename\n        - content\n        - lines\n        - lineNumbers\n        description: 'Property of FileObject/FileSet to extract:\n\n          - fullpath: Full path to the file (e.g., \"data/train/img.jpg\")\n\n          - filename: Just the filename (e.g., \"img.jpg\")\n\n          - content: Binary/text content of the file\n\n          - lines: Content split by lines\n\n          - lineNumbers: Line numbers (0-indexed)\n\n          '\n        x-jsonld-id: http://mlcommons.org/croissant/fileProperty\n      jsonPath:\n        type: string\n        description: JSONPath expression for extracting from JSON files\n        x-jsonld-id: http://mlcommons.org/croissant/jsonPath\n    x-jsonld-id: http://mlcommons.org/croissant/extract\n  transform:\n    type: object\n    description: 'Transformations to apply to extracted data.\n\n      '\n    properties:\n      regex:\n        type: string\n        description: 'Regular expression to extract or parse data.\n\n          Captured groups are returned. If no groups, the entire match is returned.\n\n          '\n        x-jsonld-id: http://mlcommons.org/croissant/regex\n      delimiter:\n        type: string\n        description: Character to split strings into arrays\n        x-jsonld-id: http://mlcommons.org/croissant/delimiter\n      jsonQuery:\n        type: string\n        description: JSON query to evaluate on JSON data\n      replace:\n        type: object\n        description: String replacement\n        properties:\n          pattern:\n            type: string\n          replacement:\n            type: string\n      separator:\n        type: string\n        description: Deprecated - use delimiter instead\n        x-jsonld-id: http://mlcommons.org/croissant/separator\n    x-jsonld-id: http://mlcommons.org/croissant/transform\n  format:\n    type: string\n    description: 'Format string for parsing extracted values into typed data.\n\n      Examples:\n\n      - Date/DateTime: \"yyyy-MM-dd\", \"MM/dd/yyyy HH:mm:ss\"\n\n      - Numbers: \"0.##E0\" (scientific notation)\n\n      - BoundingBox: \"CENTER_XYWH\", \"XYXY\"\n\n      '\n    x-jsonld-id: http://mlcommons.org/croissant/format\nexamples:\n- title: Extract CSV column\n  content: Basic extraction from a CSV file\n  snippets:\n  - language: json\n    code: \"{\\n  \\\"fileObject\\\": { \\\"@id\\\": \\\"data.csv\\\" },\\n  \\\"extract\\\": { \\\"column\\\":\n      \\\"user_name\\\" }\\n}\\n\"\n- title: Extract filename from FileSet\n  content: Get filenames from a collection of files\n  snippets:\n  - language: json\n    code: \"{\\n  \\\"fileSet\\\": { \\\"@id\\\": \\\"images\\\" },\\n  \\\"extract\\\": { \\\"fileProperty\\\":\n      \\\"filename\\\" }\\n}\\n\"\n- title: Regex transformation\n  content: Extract part of a filename using regex\n  snippets:\n  - language: json\n    code: \"{\\n  \\\"fileSet\\\": { \\\"@id\\\": \\\"images\\\" },\\n  \\\"extract\\\": { \\\"fileProperty\\\":\n      \\\"filename\\\" },\\n  \\\"transform\\\": {\\n    \\\"regex\\\": \\\"img_([0-9]+)\\\\\\\\.jpg\\\"\\n\n      \\ }\\n}\\n\"\n- title: Extract with date parsing\n  content: Parse a date column with specific format\n  snippets:\n  - language: json\n    code: \"{\\n  \\\"fileObject\\\": { \\\"@id\\\": \\\"events.csv\\\" },\\n  \\\"extract\\\": { \\\"column\\\":\n      \\\"event_date\\\" },\\n  \\\"format\\\": \\\"yyyy-MM-dd\\\"\\n}\\n\"\n- title: JSONPath extraction\n  content: Extract nested values from JSON\n  snippets:\n  - language: json\n    code: \"{\\n  \\\"fileObject\\\": { \\\"@id\\\": \\\"metadata.json\\\" },\\n  \\\"extract\\\": {\n      \\\"jsonPath\\\": \\\"$.annotations[*].category\\\" }\\n}\\n\"\n- title: Multiple transformations\n  content: Apply several transformations in sequence\n  snippets:\n  - language: json\n    code: \"{\\n  \\\"fileSet\\\": { \\\"@id\\\": \\\"images\\\" },\\n  \\\"extract\\\": { \\\"fileProperty\\\":\n      \\\"fullpath\\\" },\\n  \\\"transform\\\": [\\n    { \\\"regex\\\": \\\"^(train|val|test)/\\\"\n      },\\n    { \\\"replace\\\": { \\\"pattern\\\": \\\"val\\\", \\\"replacement\\\": \\\"validation\\\"\n      } }\\n  ]\\n}\\n\"\n- title: Split string into array\n  content: Convert delimited string to array\n  snippets:\n  - language: json\n    code: \"{\\n  \\\"fileObject\\\": { \\\"@id\\\": \\\"tags.csv\\\" },\\n  \\\"extract\\\": { \\\"column\\\":\n      \\\"tag_list\\\" },\\n  \\\"transform\\\": { \\\"delimiter\\\": \\\",\\\" }\\n}\\n\"\nx-jsonld-vocab: https://schema.org/\nx-jsonld-prefixes:\n  cr: http://mlcommons.org/croissant/\n",
  "gitRepository": "https://github.com/GeoLabs/bblocks-croissant",
  "gitPath": "_sources/datasource"
}